<!doctype html>

<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>px-overlay Demo</title>

    <!-- Import custom element. Note: see comment about relative paths to dependencies in the *.html file referenced below -->

    <link rel="import" href="../../px-theme/px-theme-styles.html">
    <!-- <link rel="import" href="../../px-dark-theme/px-dark-theme-styles.html"> -->
    <custom-style>
      <style include="px-theme-styles" is="custom-style"></style>
    </custom-style>

    <link rel="import" href="../../promise-polyfill/promise-polyfill-lite.html"/>
    <link rel="import" href="../../polymer/polymer.html"/>
    <link rel="import" href="../../polymer/lib/elements/dom-repeat.html"/>
    <link rel="import" href="../../polymer/lib/elements/dom-if.html"/>
    <link rel="import" href="../../px-modal/px-modal.html"/>
    <link rel="import" href="../../px-icon-set/px-icon-set.html"/>
    <link rel="import" href="../../px-icon-set/px-icon.html"/>
    <link rel="import" href="../px-overlay-content.html"/>
    <link rel="import" href="../px-overlay-container.html"/>
  </head>

  <body>
    <px-overlay-content>
      <div id="wrapper">
        <dom-repeat>
          <template is="dom-repeat">
            <p>[[item]]</p>
          </template>
        </dom-repeat>
      </div>
    </px-overlay-content>
    <button id="add">Add one</button>
    <button id="append">Append new content</button>

    <script>
      document.addEventListener("WebComponentsReady", () => {
        const repeater = Polymer.Element ? document.querySelector('dom-repeat') : document.querySelector('template[is="dom-repeat"]');
        const wrapper = document.getElementById('wrapper');
        const overlay = document.querySelector('px-overlay-content');
        const add = document.getElementById('add');
        const append = document.getElementById('append');

        let i = 100;

        repeater.items = [1,2,3,4,5];

        add.addEventListener('click', () => {
          const l = repeater.items.length + 1;
          repeater.push('items', l);
        });

        append.addEventListener('click', () => {
          const elem = document.createElement('div');
          elem.textContent = i++;

          wrapper.appendChild(elem);
        });
      });
    </script>

    <script type="text/javascript">
      (function() {
        'use strict';

        var onload = function() {
          // For native Imports, manually fire WebComponentsReady so user code
          // can use the same code path for native and polyfill'd imports.
          if (!window.HTMLImports) {
            document.dispatchEvent(
              new CustomEvent('WebComponentsReady', {bubbles: true})
            );
          }
        };

        var webComponentsSupported = (
          'registerElement' in document && 'import' in document.createElement('link') && 'content' in document.createElement('template')
        );

        if (!webComponentsSupported) {
          var script = document.createElement('script');
          script.async = true;
          script.src = '../webcomponentsjs/webcomponents-lite.js';
          script.onload = onload;
          document.head.appendChild(script);
        } else {
          onload();
        }
      })();
      </script>
  </body>
</html>
